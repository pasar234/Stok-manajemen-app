<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Stok Pintar Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --red: #ef4444;
            --border: #e2e8f0;
        }

        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--bg); color: var(--text); margin: 0; padding-bottom: 70px; }

        /* Header */
        .header { background: var(--primary); color: white; padding: 20px; position: sticky; top: 0; z-index: 10; }
        
        /* Tab Navigasi Atas */
        .tabs { display: flex; overflow-x: auto; background: var(--card); border-bottom: 1px solid var(--border); }
        .tab { padding: 15px 25px; cursor: pointer; font-weight: 600; color: #64748b; border-bottom: 3px solid transparent; }
        .tab.active { color: var(--primary); border-bottom-color: var(--primary); }

        /* Container */
        .container { padding: 15px; max-width: 600px; margin: 0 auto; }

        /* Pencarian (Screen 2 style) */
        .search-container { background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 15px; border: 1px solid var(--border); }
        .search-box { display: flex; align-items: center; background: #f1f5f9; padding: 10px; border-radius: 8px; }
        .search-box input { border: none; background: transparent; outline: none; width: 100%; margin-left: 10px; font-size: 16px; }

        /* LIST PRODUK (GAYA FOTO 2) */
        .product-card { 
            background: var(--card); 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 15px; 
            border-bottom: 1px solid var(--border);
        }
        .product-info { flex: 1; }
        .product-name { font-weight: 700; font-size: 1.1rem; margin-bottom: 2px; }
        .product-code { color: #64748b; font-size: 0.85rem; margin-bottom: 8px; }
        
        /* HARGA MERAH KLIK-ABLE */
        .price-red { 
            color: var(--red); 
            font-weight: 800; 
            font-size: 1.2rem; 
            cursor: pointer; 
            display: inline-block;
        }
        .price-red:hover { opacity: 0.7; text-decoration: underline; }

        /* KONTROL STOK HORIZONTAL */
        .stock-control { 
            display: flex; 
            align-items: center; 
            gap: 15px; 
            background: #f1f5f9; 
            padding: 8px 12px; 
            border-radius: 25px; 
        }
        .btn-qty { border: none; background: none; font-size: 1.4rem; color: var(--primary); cursor: pointer; font-weight: bold; }
        .stock-num { font-weight: 800; min-width: 20px; text-align: center; }

        /* MODAL EDIT */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 100; padding: 20px; }
        .modal.show { display: flex; }
        .modal-box { background: var(--card); padding: 20px; border-radius: 15px; width: 100%; max-width: 350px; }
        .modal-box h3 { margin-top: 0; }
        .modal-box input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid var(--border); border-radius: 8px; }
        .modal-btns { display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px; }
        .btn { padding: 10px 18px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; }
        .btn-save { background: var(--primary); color: white; }
        
        /* Bottom Nav */
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; display: flex; border-top: 1px solid var(--border); }
        .nav-item { flex: 1; text-align: center; padding: 12px; color: #64748b; cursor: pointer; font-size: 0.8rem; }
        .nav-item.active { color: var(--primary); }
        .nav-item i { display: block; font-size: 1.2rem; margin-bottom: 3px; }

        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="header">
        <h2 style="margin:0">Stok Pintar</h2>
        <p style="margin:0; opacity: 0.8; font-size: 0.9rem;">Manajemen Stok Produk</p>
    </div>

    <div id="screen-form" class="container">
        <div class="search-container">
            <h3>Tambah Produk Baru</h3>
            <input type="text" id="in-nama" placeholder="Nama Produk" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid var(--border)">
            <input type="text" id="in-kode" placeholder="Kode Produk" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid var(--border)">
            <input type="number" id="in-harga" placeholder="Harga Jual" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid var(--border)">
            <button class="btn btn-save" onclick="tambahProduk()" style="width:100%">SIMPAN PRODUK</button>
        </div>
    </div>

    <div id="screen-list" class="hidden">
        <div class="tabs" id="cat-tabs"></div>
        <div class="container">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search" placeholder="Cari nama atau kode..." oninput="renderList()">
            </div>
            <div id="product-list"></div>
        </div>
    </div>

    <div id="modal-edit" class="modal">
        <div class="modal-box">
            <h3 id="edit-title">Edit Harga</h3>
            <label>Harga Jual Baru:</label>
            <input type="number" id="edit-input">
            <div class="modal-btns">
                <button class="btn" onclick="tutupModal()">Batal</button>
                <button class="btn btn-save" onclick="simpanHarga()">Simpan</button>
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="showScreen('home')" id="nav-home">
            <i class="fas fa-home"></i>Home
        </div>
        <div class="nav-item" onclick="showScreen('list')" id="nav-list">
            <i class="fas fa-list"></i>Produk
        </div>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('db_stok')) || [];
        let currentCat = "NARITA";
        let editingId = null;
        const cats = ["NARITA", "VR", "KUDUS", "LAIN"];

        function showScreen(type) {
            if(type === 'home') {
                document.getElementById('screen-form').classList.remove('hidden');
                document.getElementById('screen-list').classList.add('hidden');
                document.getElementById('nav-home').classList.add('active');
                document.getElementById('nav-list').classList.remove('active');
            } else {
                document.getElementById('screen-form').classList.add('hidden');
                document.getElementById('screen-list').classList.remove('hidden');
                document.getElementById('nav-home').classList.remove('active');
                document.getElementById('nav-list').classList.add('active');
                renderTabs();
                renderList();
            }
        }

        function tambahProduk() {
            const nama = document.getElementById('in-nama').value;
            const kode = document.getElementById('in-kode').value;
            const harga = document.getElementById('in-harga').value;
            
            if(!nama || !harga) return alert("Isi nama dan harga!");

            const baru = {
                id: Date.now(),
                nama: nama,
                kode: kode || "-",
                jual: parseInt(harga),
                stok: 0,
                kategori: currentCat
            };

            db.push(baru);
            localStorage.setItem('db_stok', JSON.stringify(db));
            
            // Reset Form & Pindah ke Screen 2
            document.getElementById('in-nama').value = "";
            document.getElementById('in-kode').value = "";
            document.getElementById('in-harga').value = "";
            showScreen('list');
        }

        function renderTabs() {
            const container = document.getElementById('cat-tabs');
            container.innerHTML = cats.map(c => `
                <div class="tab ${c === currentCat ? 'active' : ''}" onclick="changeCat('${c}')">${c}</div>
            `).join('');
        }

        function changeCat(c) {
            currentCat = c;
            renderTabs();
            renderList();
        }

        function renderList() {
            const container = document.getElementById('product-list');
            const key = document.getElementById('search').value.toLowerCase();
            
            const filtered = db.filter(i => 
                i.kategori === currentCat && 
                (i.nama.toLowerCase().includes(key) || i.kode.toLowerCase().includes(key))
            );

            container.innerHTML = filtered.map(i => `
                <div class="product-card">
                    <div class="product-info">
                        <div class="product-name">${i.nama}</div>
                        <div class="product-code">Kode: ${i.kode}</div>
                        <div class="price-red" onclick="bukaModal(${i.id}, ${i.jual})">
                            Rp ${i.jual.toLocaleString('id-ID')}
                        </div>
                    </div>
                    <div class="stock-control">
                        <button class="btn-qty" onclick="ubahStok(${i.id}, -1)">-</button>
                        <span class="stock-num">${i.stok}</span>
                        <button class="btn-qty" onclick="ubahStok(${i.id}, 1)">+</button>
                    </div>
                </div>
            `).join('');
        }

        function ubahStok(id, val) {
            const idx = db.findIndex(p => p.id === id);
            db[idx].stok = Math.max(0, db[idx].stok + val);
            save();
            renderList();
        }

        function bukaModal(id, harga) {
            editingId = id;
            document.getElementById('edit-input').value = harga;
            document.getElementById('modal-edit').classList.add('show');
        }

        function tutupModal() {
            document.getElementById('modal-edit').classList.remove('show');
        }

        function simpanHarga() {
            const hBaru = parseInt(document.getElementById('edit-input').value);
            const idx = db.findIndex(p => p.id === editingId);
            db[idx].jual = hBaru;
            save();
            tutupModal();
            renderList();
        }

        function save() {
            localStorage.setItem('db_stok', JSON.stringify(db));
        }

        // Jalankan awal
        renderTabs();
    </script>
</body>
  </html>
